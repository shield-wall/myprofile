name: Stage - Workflow

on:
  push:
    branches:
      - master

jobs:
  build:
    uses: eerison/myprofile/.github/workflows/build.yml@master
    secrets: inherit
    with:
      environment: Staging

  lint_backend:
    uses: eerison/myprofile/.github/workflows/lint_backend.yml@master
    secrets: inherit
    needs: build
  
  deploy:
#    - uses: rlespinasse/github-slug-action@v3.x
    uses: eerison/myprofile/.github/workflows/deploy.yml@master
    secrets: inherit
    with:
      environment: Staging
      git_ref: stage
#        git_ref: ${{ env.GITHUB_REF_SLUG }}
    needs:
      - lint_backend
#      - test_backend

